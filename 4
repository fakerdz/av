print("Script đã khởi động")

local SaveModule = require(game.ReplicatedStorage.Library.Client.Save)
local Workspace = game:GetService("Workspace")
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")

local PlayerCharacter = Workspace:WaitForChild(Players.LocalPlayer.Name)
local PlayerHumanoidRootPart = PlayerCharacter:FindFirstChild("HumanoidRootPart")

local PositionBlueChest = CFrame.new(-23.4127789, 3.60205817, 171.047852)
local PositionSecretChest = CFrame.new(215.447311, -116.493744, -150.387924)

function OpenChest(amount, secret)
    local args = {
        [1] = amount,
        [2] = secret
    }
    game:GetService("ReplicatedStorage"):WaitForChild("Network"):WaitForChild("LootChest_Unlock"):InvokeServer(unpack(args))
end

function GetAmountOfSecretKeys()
    print("Gọi GetAmountOfSecretKeys")
    local PlayerSaves = SaveModule.GetSaves()[Players.LocalPlayer] or {}
    print("PlayerSaves:", HttpService:JSONEncode(PlayerSaves))  -- In toàn bộ PlayerSaves để kiểm tra cấu trúc
    local ItemID = "4c56817ec1f14d04ac9b5d6183bb238b"
    local Item = PlayerSaves.Inventory and PlayerSaves.Inventory.Misc and PlayerSaves.Inventory.Misc[ItemID]

    if Item then
        print("Số lượng Secret Keys:", Item._am)
        return Item._am
    else
        warn("Không tìm thấy Item với ID:", ItemID)
    end

    return 0
end

function GetAmountOfCrystalKeys()
    print("Gọi GetAmountOfCrystalKeys")
    local PlayerSaves = SaveModule.GetSaves()[Players.LocalPlayer] or {}
    print("PlayerSaves:", HttpService:JSONEncode(PlayerSaves))  -- In toàn bộ PlayerSaves để kiểm tra cấu trúc
    local ItemID = "0a2b6f00bdcb42678b17c72b055753a3"
    local Item = PlayerSaves.Inventory and PlayerSaves.Inventory.Misc and PlayerSaves.Inventory.Misc[ItemID]

    if Item then
        print("Số lượng Crystal Keys:", Item._am)
        return Item._am
    else
        warn("Không tìm thấy Item với ID:", ItemID)
    end

    return 0
end
